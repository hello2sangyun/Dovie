> rest-express@1.0.0 dev
OpenAI API key is configurederver/index.ts
1:16:01 PM [express] serving on port 5000
Browserslist: browsers data (caniuse-lite) is 8 months old. Please run:
  npx update-browserslist-db@latest
  Why you should do it regularly: https://github.com/browserslist/update-db#readme
1:16:12 PM [express] GET /api/auth/me 304 in 190ms :: {"user":{"id":91,"username":"strong","displayN…
1:16:17 PM [express] GET /api/auth/me 200 in 41ms :: {"user":{"id":91,"username":"strong","displayNa…
1:16:23 PM [express] POST /api/auth/login 200 in 177ms :: {"user":{"id":91,"username":"strong","disp…
1:16:23 PM [express] GET /api/contacts 200 in 43ms :: {"contacts":[{"id":55,"userId":91,"contactUser…
1:16:24 PM [express] GET /api/chat-rooms 304 in 825ms :: {"chatRooms":[{"id":86,"name":"하이 테스트","isG…
1:16:24 PM [express] GET /api/chat-rooms/86/messages 304 in 41ms :: {"messages":[{"id":360,"chatRoom…
1:16:24 PM [express] GET /api/chat-rooms/85/messages 304 in 39ms :: {"messages":[]}
1:16:24 PM [express] GET /api/chat-rooms/84/messages 304 in 40ms :: {"messages":[]}
1:16:24 PM [express] GET /api/unread-counts 304 in 1288ms :: {"unreadCounts":[]}
1:16:24 PM [express] GET /api/chat-rooms/83/messages 304 in 44ms :: {"messages":[{"id":343,"chatRoom…
1:16:24 PM [express] GET /api/chat-rooms/69/messages 304 in 39ms :: {"messages":[]}
1:16:25 PM [express] GET /api/person-folders 200 in 41ms :: [{"id":25,"userId":91,"contactId":80,"pe…
1:16:26 PM [express] GET /api/person-folders 304 in 40ms :: [{"id":25,"userId":91,"contactId":80,"pe…
1:16:26 PM [express] GET /api/person-folders 304 in 41ms :: [{"id":25,"userId":91,"contactId":80,"pe…
1:16:28 PM [vite] hmr update /src/components/PersonFolderDetail.tsx, /src/index.css?v=Baj5mmY3HYPGk42Ma4A8j
Processing business card image: IMG_3155.jpg 154936 bytes
Starting business card analysis with OpenAI Vision API
Business card analysis completed successfully: {
  name: 'Stan Lee',
  company: 'CB Engineering',
  jobTitle: 'Managing director',
  email: 'hello2sagyun@gmail.com',
  phone: '+36 70 356 66 30',
  address: 'H-2900 Komárom, Bánki Donát u. 4.'
}
1:16:36 PM [express] POST /api/scan-business-card 200 in 4607ms :: {"name":"Stan Lee","company":"CB …
POST /api/contacts - Request body: {
  name: 'Stan Lee',
  company: 'CB Engineering',
  jobTitle: 'Managing director',
  email: 'hello2sagyun@gmail.com',
  phone: '+36 70 356 66 30',
  address: 'H-2900 Komárom, Bánki Donát u. 4.'
}
POST /api/contacts - User ID from header: 91
Creating external contact from business card data
Creating external contact with data: {
  userId: 91,
  contactUserId: null,
  nickname: 'Stan Lee',
  name: 'Stan Lee',
  email: 'hello2sagyun@gmail.com',
  phone: '+36 70 356 66 30',
  company: 'CB Engineering',
  jobTitle: 'Managing director',
  notes: undefined
}
External contact created successfully: {
  id: 81,
  userId: 91,
  contactUserId: null,
  nickname: 'Stan Lee',
  name: 'Stan Lee',
  email: 'hello2sagyun@gmail.com',
  phone: '+36 70 356 66 30',
  company: 'CB Engineering',
  jobTitle: 'Managing director',
  notes: null,
  isPinned: false,
  isFavorite: false,
  isBlocked: false,
  createdAt: 2025-06-12T13:16:38.427Z
}
1:16:38 PM [express] POST /api/contacts 200 in 47ms :: {"contact":{"id":81,"userId":91,"contactUserI…
createPersonFolder called with: { userId: 91, contactId: 81, folderName: 'Stan Lee' }
Executing direct pool query: 
        INSERT INTO person_folders (user_id, contact_id, person_name, folder_name, last_activity, item_count, created_at, updated_at)
        VALUES ($1, $2, $3, $4, NOW(), 0, NOW(), NOW())
        RETURNING *
      
With values: [ 91, 81, 'Stan Lee', 'Stan Lee' ]
Created folder: {
  id: 26,
  user_id: 91,
  contact_id: 81,
  person_name: 'Stan Lee',
  created_at: 2025-06-12T13:16:38.600Z,
  updated_at: 2025-06-12T13:16:38.600Z,
  folder_name: 'Stan Lee',
  avatar_url: null,
  last_activity: 2025-06-12T13:16:38.600Z,
  item_count: 0
}
1:16:38 PM [express] POST /api/person-folders 200 in 40ms :: {"id":26,"user_id":91,"contact_id":81,"…
Error adding folder item: error: column "item_id" of relation "folder_items" does not exist
    at file:///home/runner/workspace/node_modules/@neondatabase/serverless/index.mjs:1345:74
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async NeonPreparedQuery.execute (/home/runner/workspace/node_modules/src/neon-serverless/session.ts:102:18)
    at async DatabaseStorage.addFolderItem (/home/runner/workspace/server/storage.ts:1284:20)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:885:20) {
  length: 132,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '61',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1066',
  routine: 'checkInsertTargets'
}
1:16:38 PM [express] POST /api/person-folders/26/items 500 in 49ms :: {"message":"Failed to add fold…
1:16:40 PM [express] GET /api/person-folders 200 in 164ms :: [{"id":26,"userId":91,"contactId":81,"p…
1:16:40 PM [express] GET /api/contacts 200 in 190ms :: {"contacts":[{"id":55,"userId":91,"contactUse…
1:16:42 PM [express] GET /api/person-folders 304 in 39ms :: [{"id":26,"userId":91,"contactId":81,"pe…
1:16:42 PM [express] GET /api/person-folders 304 in 39ms :: [{"id":26,"userId":91,"contactId":81,"pe…
1:16:43 PM [express] GET /api/person-folders 304 in 38ms :: [{"id":26,"userId":91,"contactId":81,"pe…
1:16:43 PM [express] GET /api/person-folders 304 in 39ms :: [{"id":26,"userId":91,"contactId":81,"pe…
1:16:46 PM [express] GET /api/unread-counts 304 in 1254ms :: {"unreadCounts":[]}
1:16:53 PM [express] GET /api/unread-counts 304 in 1250ms :: {"unreadCounts":[]}
1:16:53 PM [express] GET /api/contacts/recent-posts 400 in 1ms :: {"message":"Invalid contact ID"}
1:16:54 PM [express] GET /api/contacts/recent-posts 400 in 0ms :: {"message":"Invalid contact ID"}
1:16:56 PM [express] GET /api/contacts/recent-posts 400 in 0ms :: {"message":"Invalid contact ID"}
1:16:59 PM [express] GET /api/unread-counts 304 in 1250ms :: {"unreadCounts":[]}
1:17:12 PM [express] GET /api/auth/me 304 in 165ms :: {"user":{"id":91,"username":"strong","displayN…
1:17:57 PM [express] GET /api/auth/me 200 in 168ms :: {"user":{"id":91,"username":"strong","displayN…
1:18:34 PM [express] GET /api/auth/me 200 in 161ms :: {"user":{"id":91,"username":"strong","displayN…
1:18:38 PM [express] POST /api/auth/login 200 in 172ms :: {"user":{"id":91,"username":"strong","disp…
1:18:38 PM [express] GET /api/contacts 304 in 43ms :: {"contacts":[{"id":55,"userId":91,"contactUser…
1:18:39 PM [express] GET /api/chat-rooms 304 in 869ms :: {"chatRooms":[{"id":86,"name":"하이 테스트","isG…
1:18:39 PM [express] GET /api/chat-rooms/86/messages 304 in 40ms :: {"messages":[{"id":360,"chatRoom…
1:18:39 PM [express] GET /api/chat-rooms/85/messages 304 in 41ms :: {"messages":[]}
1:18:39 PM [express] GET /api/chat-rooms/84/messages 304 in 40ms :: {"messages":[]}
1:18:39 PM [express] GET /api/chat-rooms/83/messages 304 in 45ms :: {"messages":[{"id":343,"chatRoom…
1:18:39 PM [express] GET /api/unread-counts 304 in 1430ms :: {"unreadCounts":[]}
1:18:39 PM [express] GET /api/chat-rooms/69/messages 304 in 41ms :: {"messages":[]}
1:18:40 PM [express] GET /api/person-folders 304 in 42ms :: [{"id":26,"userId":91,"contactId":81,"pe…
1:18:41 PM [express] GET /api/person-folders 304 in 40ms :: [{"id":26,"userId":91,"contactId":81,"pe…
1:18:41 PM [express] GET /api/person-folders 304 in 41ms :: [{"id":26,"userId":91,"contactId":81,"pe…
1:18:42 PM [express] GET /api/person-folders 304 in 41ms :: [{"id":26,"userId":91,"contactId":81,"pe…
1:18:42 PM [express] GET /api/person-folders 304 in 40ms :: [{"id":26,"userId":91,"contactId":81,"pe…
1:18:44 PM [express] DELETE /api/person-folders/26 200 in 81ms :: {"success":true}
1:18:44 PM [express] GET /api/person-folders 200 in 44ms :: [{"id":25,"userId":91,"contactId":80,"pe…
1:18:44 PM [express] GET /api/person-folders 200 in 47ms :: [{"id":25,"userId":91,"contactId":80,"pe…
1:18:44 PM [express] GET /api/person-folders 200 in 47ms :: [{"id":25,"userId":91,"contactId":80,"pe…
1:18:46 PM [express] DELETE /api/person-folders/25 200 in 77ms :: {"success":true}
1:18:46 PM [express] GET /api/person-folders 200 in 39ms :: []
1:18:46 PM [express] GET /api/person-folders 200 in 40ms :: []
1:18:46 PM [express] GET /api/person-folders 200 in 38ms :: []
1:18:47 PM [express] GET /api/unread-counts 304 in 1287ms :: {"unreadCounts":[]}
Processing business card image: IMG_3155.jpg 154936 bytes
Starting business card analysis with OpenAI Vision API
Business card analysis completed successfully: {
  company: 'CB Engineering',
  name: 'Stan Lee',
  jobTitle: 'Managing director',
  email: 'hello2sagyun@gmail.com',
  phone: '+36 70 356 66 30',
  address: 'H-2900 Komárom, Bánki Donát u. 4.'
}
1:19:01 PM [express] POST /api/scan-business-card 200 in 10971ms :: {"company":"CB Engineering","nam…
POST /api/contacts - Request body: {
  name: 'Stan Lee',
  company: 'CB Engineering',
  jobTitle: 'Managing director',
  email: 'hello2sagyun@gmail.com',
  phone: '+36 70 356 66 30',
  address: 'H-2900 Komárom, Bánki Donát u. 4.'
}
POST /api/contacts - User ID from header: 91
Creating external contact from business card data
Creating external contact with data: {
  userId: 91,
  contactUserId: null,
  nickname: 'Stan Lee',
  name: 'Stan Lee',
  email: 'hello2sagyun@gmail.com',
  phone: '+36 70 356 66 30',
  company: 'CB Engineering',
  jobTitle: 'Managing director',
  notes: undefined
}
External contact created successfully: {
  id: 82,
  userId: 91,
  contactUserId: null,
  nickname: 'Stan Lee',
  name: 'Stan Lee',
  email: 'hello2sagyun@gmail.com',
  phone: '+36 70 356 66 30',
  company: 'CB Engineering',
  jobTitle: 'Managing director',
  notes: null,
  isPinned: false,
  isFavorite: false,
  isBlocked: false,
  createdAt: 2025-06-12T13:19:03.558Z
}
1:19:03 PM [express] POST /api/contacts 200 in 173ms :: {"contact":{"id":82,"userId":91,"contactUser…
createPersonFolder called with: { userId: 91, contactId: 82, folderName: 'Stan Lee' }
Executing direct pool query: 
        INSERT INTO person_folders (user_id, contact_id, person_name, folder_name, last_activity, item_count, created_at, updated_at)
        VALUES ($1, $2, $3, $4, NOW(), 0, NOW(), NOW())
        RETURNING *
      
With values: [ 91, 82, 'Stan Lee', 'Stan Lee' ]
Created folder: {
  id: 27,
  user_id: 91,
  contact_id: 82,
  person_name: 'Stan Lee',
  created_at: 2025-06-12T13:19:03.731Z,
  updated_at: 2025-06-12T13:19:03.731Z,
  folder_name: 'Stan Lee',
  avatar_url: null,
  last_activity: 2025-06-12T13:19:03.731Z,
  item_count: 0
}
1:19:03 PM [express] POST /api/person-folders 200 in 45ms :: {"id":27,"user_id":91,"contact_id":82,"…
Error adding folder item: error: column "item_id" of relation "folder_items" does not exist
    at file:///home/runner/workspace/node_modules/@neondatabase/serverless/index.mjs:1345:74
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async NeonPreparedQuery.execute (/home/runner/workspace/node_modules/src/neon-serverless/session.ts:102:18)
    at async DatabaseStorage.addFolderItem (/home/runner/workspace/server/storage.ts:1284:20)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:885:20) {
  length: 132,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '61',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1066',
  routine: 'checkInsertTargets'
}
1:19:03 PM [express] POST /api/person-folders/27/items 500 in 41ms :: {"message":"Failed to add fold…
1:19:05 PM [express] GET /api/person-folders 200 in 170ms :: [{"id":27,"userId":91,"contactId":82,"p…
1:19:05 PM [express] GET /api/contacts 200 in 171ms :: {"contacts":[{"id":55,"userId":91,"contactUse…
1:19:06 PM [express] GET /api/person-folders 304 in 55ms :: [{"id":27,"userId":91,"contactId":82,"pe…
1:19:06 PM [express] GET /api/person-folders 304 in 40ms :: [{"id":27,"userId":91,"contactId":82,"pe…
1:19:06 PM [express] GET /api/auth/me 200 in 43ms :: {"user":{"id":91,"username":"strong","displayNa…
1:19:11 PM [express] GET /api/unread-counts 304 in 1264ms :: {"unreadCounts":[]}
1:19:13 PM [express] GET /api/contacts/recent-posts 400 in 1ms :: {"message":"Invalid contact ID"}
1:19:14 PM [express] GET /api/contacts/recent-posts 400 in 1ms :: {"message":"Invalid contact ID"}
1:19:21 PM [express] GET /api/contacts/recent-posts 400 in 0ms :: {"message":"Invalid contact ID"}
1:19:22 PM [express] GET /api/unread-counts 304 in 1382ms :: {"unreadCounts":[]}
1:19:28 PM [express] GET /api/auth/me 200 in 39ms :: {"user":{"id":91,"username":"strong","displayNa…
1:19:44 PM [express] GET /api/unread-counts 304 in 1402ms :: {"unreadCounts":[]}
1:19:59 PM [express] GET /api/auth/me 304 in 159ms :: {"user":{"id":91,"username":"strong","displayN…
