 WebSocket connection to 'wss://85060192-a63a-4476-a654-17f1dcfbd4a2-00-2gd912molkufa.worf.replit.dev/?token=O4-wLWwGYpb1' failed: 
setupWebSocket @ client:536
client:536 Uncaught (in promise) 
 Download the React DevTools for a better development experience: https://reactjs.org/link/react-devtools
 [SW] Service Worker support check: Object
 [CallSessionStore] BroadcastChannel initialized
 >=116
 ğŸš€ PWA Service Worker ê°•ì œ ë“±ë¡ ì‹œì‘...
 ğŸ” ë””ë°”ì´ìŠ¤ ì •ë³´: Object
 [SW] Call session cleanup interval initialized
 [SW] Installing service worker...
 [SW] Service Worker registered successfully: https://85060192-a63a-4476-a654-17f1dcfbd4a2-00-2gd912molkufa.worf.replit.dev/
 [SW] Caching static assets
 ğŸ”„ Auth context updating user: 121 profilePicture: /uploads/profile_1761144817232_rf4rde1nn4e.jpg
 ğŸ”Œ Connecting to WebSocket: wss://85060192-a63a-4476-a654-17f1dcfbd4a2-00-2gd912molkufa.worf.replit.dev/ws
    Protocol: wss:, Host: 85060192-a63a-4476-a654-17f1dcfbd4a2-00-2gd912molkufa.worf.replit.dev
 WebSocket connected successfully
 Processing 0 pending messages
 WebSocket message received: Object
 WebSocket authentication successful for user: 121
 [SW] Static assets cached successfully
 [SW] Activating service worker...
 [CallSessionStore] CALL_READY sent to SW via registration.active
 [SW] Service worker activated
 [SW] Message received: Object
 [SW] Client ready for pending call sessions
 [SW] Message received: Object
 [PWA] Install prompt triggered
 [SW] Retrieved pending call sessions: 0
 [SW] No pending call sessions to deliver
app:1 Banner not shown: beforeinstallpromptevent.preventDefault() called. The page must call beforeinstallpromptevent.prompt() to show the banner.
 âœ… PWA Service Worker ë“±ë¡ ì„±ê³µ: https://85060192-a63a-4476-a654-17f1dcfbd4a2-00-2gd912molkufa.worf.replit.dev/
 âœ… PWA Service Worker ì¤€ë¹„ ì™„ë£Œ
 ğŸ”” í˜„ì¬ ì•Œë¦¼ ê¶Œí•œ: default
 [NotificationManager] Initializing Telegram-style activity tracking
usePWABadge.tsx:82 ğŸš€ PWA ë°°ì§€ ì‹œìŠ¤í…œ ì´ˆê¸°í™” - ë°ì´í„°ë² ì´ìŠ¤ ê¸°ë°˜
navigation.ts:9 âœ… Navigation service registered
MainApp.tsx:114 âœ… Navigator registered with navigation service
MainApp.tsx:438 MainApp rendering with user: 121
usePWABadge.tsx:25 ğŸ”¢ PWA ë°°ì§€ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ ì¹´ìš´íŠ¸ë¡œ ì„¤ì •: 0
usePWABadge.tsx:37 âœ… PWA ë°°ì§€ í´ë¦¬ì–´ë¨ (ì½ì§€ ì•Šì€ ë©”ì‹œì§€ ì—†ìŒ)
sw.js:736 [SW] Message received: Object
sw.js:777 [SW] Badge system initialized - independent mode
sw.js:1066 [SW] Message received: Object
useIndependentBadge.tsx:34 [Badge] Independent badge system initialized
TelegramStyleNotificationManager.tsx:154 [NotificationManager] Activity status updated: online
useMicrophonePermission.tsx:26 âœ… Microphone permission previously granted (no stream created)
useMicrophonePermission.tsx:26 âœ… Microphone permission previously granted (no stream created)
b7661f8add9fd0a355af9a70fd0244ff:1  Failed to load resource: the server responded with a status of 404 (Not Found)
usePWABadge.tsx:59 ğŸ“Š ì‹¤ì œ ì½ì§€ ì•Šì€ ë©”ì‹œì§€ ìˆ˜: 0
usePWABadge.tsx:60 ğŸ“Š ê° ì±„íŒ…ë°©ë³„ ì½ì§€ ì•Šì€ ë©”ì‹œì§€: Array(0)
usePWABadge.tsx:25 ğŸ”¢ PWA ë°°ì§€ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ ì¹´ìš´íŠ¸ë¡œ ì„¤ì •: 0
usePWABadge.tsx:37 âœ… PWA ë°°ì§€ í´ë¦¬ì–´ë¨ (ì½ì§€ ì•Šì€ ë©”ì‹œì§€ ì—†ìŒ)
sw.js:736 [SW] Message received: Object
sw.js:741 [SW] Setting badge to exact database count: 0
sw.js:347 [SW] ğŸ“± Setting independent badge: 0
sw.js:1066 [SW] Message received: Object
sw.js:358 [SW] âœ… Badge cleared (0 unread)
sw.js:674 [SW] Retrieved pending call sessions: 0
TelegramStyleNotificationManager.tsx:64 [NotificationManager] Window blurred
useAppState.ts:15 ğŸ“± App state changed: background
useAppState.ts:15 ğŸ“± App state changed: background
useAppState.ts:15 ğŸ“± App state changed: background
useAppState.ts:15 ğŸ“± App state changed: background
useAppState.ts:15 ğŸ“± App state changed: background
useAppState.ts:15 ğŸ“± App state changed: background
useAppState.ts:15 ğŸ“± App state changed: background
TelegramStyleNotificationManager.tsx:42 [NotificationManager] App hidden - enabling notifications
useWebSocket.tsx:438 ğŸ“± App backgrounded - closing WebSocket to save battery
sw.js:736 [SW] Message received: Object
sw.js:791 [SW] Enabling background badge refresh
sw.js:1066 [SW] Message received: Object
useWebSocket.tsx:352 WebSocket disconnected: 1000 App backgrounded
useWebSocket.tsx:363 ğŸ“± Not reconnecting - app in background or intentionally closed
TelegramStyleNotificationManager.tsx:154 [NotificationManager] Activity status updated: offline
useCallSessionStore.tsx:783 [CallSessionStore] App became visible, sending CALL_READY
useCallSessionStore.tsx:734 [CallSessionStore] CALL_READY sent to SW via controller
useAppState.ts:15 ğŸ“± App state changed: active
useAppState.ts:15 ğŸ“± App state changed: active
useAppState.ts:15 ğŸ“± App state changed: active
useAppState.ts:15 ğŸ“± App state changed: active
useAppState.ts:15 ğŸ“± App state changed: active
useAppState.ts:15 ğŸ“± App state changed: active
useAppState.ts:15 ğŸ“± App state changed: active
TelegramStyleNotificationManager.tsx:46 [NotificationManager] App visible - suppressing notifications
usePWABadge.tsx:105 ğŸ¯ ì•± í¬ì»¤ìŠ¤ë¨ - Service Workerì— ì•Œë¦¼
usePWABadge.tsx:137 ğŸ“± ì•±ì´ í™œì„±í™”ë¨ - ë°°ì§€ ìƒíƒœ ìƒˆë¡œê³ ì¹¨
MainApp.tsx:145 ğŸ”„ PWA app opened - syncing messages immediately
usePWABadge.tsx:25 ğŸ”¢ PWA ë°°ì§€ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ ì¹´ìš´íŠ¸ë¡œ ì„¤ì •: 0
usePWABadge.tsx:37 âœ… PWA ë°°ì§€ í´ë¦¬ì–´ë¨ (ì½ì§€ ì•Šì€ ë©”ì‹œì§€ ì—†ìŒ)
TelegramStyleNotificationManager.tsx:57 [NotificationManager] Window focused
usePWABadge.tsx:105 ğŸ¯ ì•± í¬ì»¤ìŠ¤ë¨ - Service Workerì— ì•Œë¦¼
usePWABadge.tsx:144 ğŸ” ìœˆë„ìš° í¬ì»¤ìŠ¤ - ë°°ì§€ ìƒíƒœ ìƒˆë¡œê³ ì¹¨
MainApp.tsx:161 ğŸ”„ PWA app focused - syncing messages immediately
usePWABadge.tsx:25 ğŸ”¢ PWA ë°°ì§€ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ ì¹´ìš´íŠ¸ë¡œ ì„¤ì •: 0
usePWABadge.tsx:37 âœ… PWA ë°°ì§€ í´ë¦¬ì–´ë¨ (ì½ì§€ ì•Šì€ ë©”ì‹œì§€ ì—†ìŒ)
useWebSocket.tsx:459 ğŸ“± App foregrounded - reconnecting WebSocket
sw.js:736 [SW] Message received: Object
sw.js:801 [SW] Client ready for pending call sessions
sw.js:1066 [SW] Message received: Object
sw.js:736 [SW] Message received: Object
sw.js:781 [SW] App focused - badge remains database-accurate
sw.js:1066 [SW] Message received: Object
sw.js:736 [SW] Message received: Object
sw.js:781 [SW] App focused - badge remains database-accurate
sw.js:1066 [SW] Message received: Object
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:830 [SW] No pending call sessions to deliver
useWebSocket.tsx:465 ğŸ“± Calling connect() after foreground transition
useWebSocket.tsx:127 ğŸ”Œ Connecting to WebSocket: wss://85060192-a63a-4476-a654-17f1dcfbd4a2-00-2gd912molkufa.worf.replit.dev/ws
useWebSocket.tsx:128    Protocol: wss:, Host: 85060192-a63a-4476-a654-17f1dcfbd4a2-00-2gd912molkufa.worf.replit.dev
TelegramStyleNotificationManager.tsx:154 [NotificationManager] Activity status updated: online
TelegramStyleNotificationManager.tsx:154 [NotificationManager] Activity status updated: online
useWebSocket.tsx:139 WebSocket connected successfully
useWebSocket.tsx:97 Processing 0 pending messages
useWebSocket.tsx:173 WebSocket message received: Object
useWebSocket.tsx:177 WebSocket authentication successful for user: 121
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:736 [SW] Message received: Object
sw.js:762 [SW] Setting badge count: 0
sw.js:347 [SW] ğŸ“± Setting independent badge: 0
sw.js:1066 [SW] Message received: Object
sw.js:358 [SW] âœ… Badge cleared (0 unread)
sw.js:736 [SW] Message received: Object
sw.js:762 [SW] Setting badge count: 0
sw.js:347 [SW] ğŸ“± Setting independent badge: 0
sw.js:1066 [SW] Message received: Object
sw.js:358 [SW] âœ… Badge cleared (0 unread)
sw.js:674 [SW] Retrieved pending call sessions: 0
TelegramStyleNotificationManager.tsx:64 [NotificationManager] Window blurred
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:674 [SW] Retrieved pending call sessions: 0
The resource <URL> was preloaded using link preload but not used within a few seconds from the window's load event. Please make sure it has an appropriate `as` value and it is preloaded intentionally.
The resource <URL> was preloaded using link preload but not used within a few seconds from the window's load event. Please make sure it has an appropriate `as` value and it is preloaded intentionally.
The resource <URL> was preloaded using link preload but not used within a few seconds from the window's load event. Please make sure it has an appropriate `as` value and it is preloaded intentionally.
The resource <URL> was preloaded using link preload but not used within a few seconds from the window's load event. Please make sure it has an appropriate `as` value and it is preloaded intentionally.
The resource <URL> was preloaded using link preload but not used within a few seconds from the window's load event. Please make sure it has an appropriate `as` value and it is preloaded intentionally.
The resource <URL> was preloaded using link preload but not used within a few seconds from the window's load event. Please make sure it has an appropriate `as` value and it is preloaded intentionally.
The resource <URL> was preloaded using link preload but not used within a few seconds from the window's load event. Please make sure it has an appropriate `as` value and it is preloaded intentionally.
The resource <URL> was preloaded using link preload but not used within a few seconds from the window's load event. Please make sure it has an appropriate `as` value and it is preloaded intentionally.
sw.js:1110 [SW] Syncing badge count with server
sw.js:674 [SW] Retrieved pending call sessions: 0
useWebSocket.tsx:173 WebSocket message received: {type: 'call-ice-candidate', targetUserId: 121, callSessionId: 'call_1763097983889_bla7w9q35', candidate: {â€¦}, fromUserId: 126}
MainApp.tsx:189 ğŸ“ WebSocket signaling event: call-ice-candidate
useCallSessionStore.tsx:640 [CallSessionStore] handleIceCandidate: No active session
(anonymous) @ useCallSessionStore.tsx:640
handleSignaling @ MainApp.tsx:223
(anonymous) @ useWebSocket.tsx:336
ws.onmessage @ useWebSocket.tsx:334
useWebSocket.tsx:173 WebSocket message received: {type: 'call-offer', targetUserId: 121, chatRoomId: 119, callSessionId: 'call_1763097983889_bla7w9q35', callType: 'voice',Â â€¦}
MainApp.tsx:189 ğŸ“ WebSocket signaling event: call-offer
useCallSessionStore.tsx:609 [CallSessionStore] Successfully claimed incoming call: call_1763097983889_bla7w9q35
useWebSocket.tsx:173 WebSocket message received: {type: 'call-ice-candidate', targetUserId: 121, callSessionId: 'call_1763097983889_bla7w9q35', candidate: {â€¦}, fromUserId: 126}
MainApp.tsx:189 ğŸ“ WebSocket signaling event: call-ice-candidate
useCallSessionStore.tsx:640 [CallSessionStore] handleIceCandidate: No active session
(anonymous) @ useCallSessionStore.tsx:640
handleSignaling @ MainApp.tsx:223
(anonymous) @ useWebSocket.tsx:336
ws.onmessage @ useWebSocket.tsx:334
useCallSessionStore.tsx:50 [CallSessionStore] Session created: call_1763097983889_bla7w9q35, state: ringing
useCallSessionStore.tsx:118 [CallSessionStore] Session claimed: call_1763097983889_bla7w9q35
CallModal.tsx:67 ğŸ“ CallModal useEffect triggered: {isOpen: true, isIncoming: true, hasAnswered: false}
CallModal.tsx:76 ğŸ“ Incoming call - waiting for user to answer
useCallSessionStore.tsx:734 [CallSessionStore] CALL_READY sent to SW via controller
sw.js:736 [SW] Message received: {type: 'CALL_READY', clientId: 'client_1763097955867_pwmx0j0wn'}
sw.js:801 [SW] Client ready for pending call sessions
sw.js:1066 [SW] Message received: {type: 'CALL_READY', clientId: 'client_1763097955867_pwmx0j0wn'}
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:830 [SW] No pending call sessions to deliver
TelegramStyleNotificationManager.tsx:57 [NotificationManager] Window focused
usePWABadge.tsx:105 ğŸ¯ ì•± í¬ì»¤ìŠ¤ë¨ - Service Workerì— ì•Œë¦¼
usePWABadge.tsx:144 ğŸ” ìœˆë„ìš° í¬ì»¤ìŠ¤ - ë°°ì§€ ìƒíƒœ ìƒˆë¡œê³ ì¹¨
MainApp.tsx:161 ğŸ”„ PWA app focused - syncing messages immediately
usePWABadge.tsx:25 ğŸ”¢ PWA ë°°ì§€ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ ì¹´ìš´íŠ¸ë¡œ ì„¤ì •: 0
usePWABadge.tsx:37 âœ… PWA ë°°ì§€ í´ë¦¬ì–´ë¨ (ì½ì§€ ì•Šì€ ë©”ì‹œì§€ ì—†ìŒ)
sw.js:736 [SW] Message received: {type: 'APP_FOCUS'}
sw.js:781 [SW] App focused - badge remains database-accurate
sw.js:1066 [SW] Message received: {type: 'APP_FOCUS'}
CallModal.tsx:67 ğŸ“ CallModal useEffect triggered: {isOpen: true, isIncoming: true, hasAnswered: true}
CallModal.tsx:80 ğŸ“ Setting up call...
CallModal.tsx:84 ğŸ“ Getting local media stream...
CallModal.tsx:94 ğŸ“ Local stream acquired: ['audio: MacBook Air Microphone (Built-in)']
CallModal.tsx:97 ğŸ“ Creating peer connection...
CallModal.tsx:100 ğŸ“ Peer connection created
CallModal.tsx:109 ğŸ“ Received remote track: audio
TelegramStyleNotificationManager.tsx:154 [NotificationManager] Activity status updated: online
CallModal.tsx:123 ğŸ“ Remote audio playing successfully
useWebSocket.tsx:481 Message msg_1763097987411_0t8buyuc4 sent immediately
CallModal.tsx:138 ğŸ“ Sending ICE candidate
useWebSocket.tsx:481 Message msg_1763097987412_p33faifct sent immediately
CallModal.tsx:138 ğŸ“ Sending ICE candidate
useWebSocket.tsx:481 Message msg_1763097987412_gy2zjcj7e sent immediately
CallModal.tsx:138 ğŸ“ Sending ICE candidate
useWebSocket.tsx:481 Message msg_1763097987412_2cxpxai64 sent immediately
CallModal.tsx:138 ğŸ“ Sending ICE candidate
useWebSocket.tsx:481 Message msg_1763097987443_tj9dxzdgh sent immediately
CallModal.tsx:138 ğŸ“ Sending ICE candidate
useWebSocket.tsx:481 Message msg_1763097987537_d5lg6y114 sent immediately
CallModal.tsx:138 ğŸ“ Sending ICE candidate
useWebSocket.tsx:481 Message msg_1763097987537_bx4a0ydfp sent immediately
CallModal.tsx:138 ğŸ“ Sending ICE candidate
useWebSocket.tsx:481 Message msg_1763097987538_8eek9txsf sent immediately
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:736 [SW] Message received: {type: 'TELEGRAM_STYLE_BADGE', count: 0, source: 'app_focus_sync'}
sw.js:762 [SW] Setting badge count: 0
sw.js:347 [SW] ğŸ“± Setting independent badge: 0
sw.js:1066 [SW] Message received: {type: 'TELEGRAM_STYLE_BADGE', count: 0, source: 'app_focus_sync'}
sw.js:358 [SW] âœ… Badge cleared (0 unread)
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:674 [SW] Retrieved pending call sessions: 0
useWebSocket.tsx:173 WebSocket message received: {type: 'call-end', targetUserId: 121, callSessionId: 'call_1763097983889_bla7w9q35', fromUserId: 126}
CallModal.tsx:490 ğŸ“ CallModal received signaling message: call-end
useWebSocket.tsx:481 Message msg_1763098002926_7izayyqvj sent immediately
MainApp.tsx:189 ğŸ“ WebSocket signaling event: call-end
useCallSessionStore.tsx:77 [CallSessionStore] Session state changed: call_1763097983889_bla7w9q35 â†’ ended
useCallSessionStore.tsx:87 [CallSessionStore] Session call_1763097983889_bla7w9q35 reached terminal state, cleaning up
useCallSessionStore.tsx:734 [CallSessionStore] CALL_READY sent to SW via controller
sw.js:736 [SW] Message received: {type: 'CALL_READY', clientId: 'client_1763097955867_pwmx0j0wn'}
sw.js:801 [SW] Client ready for pending call sessions
sw.js:1066 [SW] Message received: {type: 'CALL_READY', clientId: 'client_1763097955867_pwmx0j0wn'}
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:830 [SW] No pending call sessions to deliver
useWebSocket.tsx:173 WebSocket message received: {type: 'call-end', targetUserId: 121, callSessionId: 'call_1763097983889_bla7w9q35', fromUserId: 126}
CallModal.tsx:490 ğŸ“ CallModal received signaling message: call-end
useWebSocket.tsx:481 Message msg_1763098003316_4a21794op sent immediately
MainApp.tsx:189 ğŸ“ WebSocket signaling event: call-end
useCallSessionStore.tsx:77 [CallSessionStore] Session state changed: call_1763097983889_bla7w9q35 â†’ ended
useCallSessionStore.tsx:87 [CallSessionStore] Session call_1763097983889_bla7w9q35 reached terminal state, cleaning up
useCallSessionStore.tsx:711 [CallSessionStore] CALL_READY throttled
useWebSocket.tsx:173 WebSocket message received: {type: 'call-end', targetUserId: 121, callSessionId: 'call_1763097983889_bla7w9q35', fromUserId: 126}
CallModal.tsx:490 ğŸ“ CallModal received signaling message: call-end
useWebSocket.tsx:481 Message msg_1763098003701_try6aje9h sent immediately
MainApp.tsx:189 ğŸ“ WebSocket signaling event: call-end
useCallSessionStore.tsx:77 [CallSessionStore] Session state changed: call_1763097983889_bla7w9q35 â†’ ended
useCallSessionStore.tsx:87 [CallSessionStore] Session call_1763097983889_bla7w9q35 reached terminal state, cleaning up
useCallSessionStore.tsx:711 [CallSessionStore] CALL_READY throttled
useCallSessionStore.tsx:128 [CallSessionStore] Session released: call_1763097983889_bla7w9q35
useCallSessionStore.tsx:711 [CallSessionStore] CALL_READY throttled
useCallSessionStore.tsx:128 [CallSessionStore] Session released: call_1763097983889_bla7w9q35
useCallSessionStore.tsx:711 [CallSessionStore] CALL_READY throttled
useCallSessionStore.tsx:128 [CallSessionStore] Session released: call_1763097983889_bla7w9q35
useCallSessionStore.tsx:711 [CallSessionStore] CALL_READY throttled
sw.js:674 [SW] Retrieved pending call sessions: 0
TelegramStyleNotificationManager.tsx:64 [NotificationManager] Window blurred
useCallSessionStore.tsx:94 [CallSessionStore] Removing terminal session: call_1763097983889_bla7w9q35
useCallSessionStore.tsx:148 [CallSessionStore] Session removed: call_1763097983889_bla7w9q35
useCallSessionStore.tsx:734 [CallSessionStore] CALL_READY sent to SW via controller
sw.js:736 [SW] Message received: {type: 'CALL_READY', clientId: 'client_1763097955867_pwmx0j0wn'}
sw.js:801 [SW] Client ready for pending call sessions
sw.js:1066 [SW] Message received: {type: 'CALL_READY', clientId: 'client_1763097955867_pwmx0j0wn'}
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:830 [SW] No pending call sessions to deliver
useCallSessionStore.tsx:94 [CallSessionStore] Removing terminal session: call_1763097983889_bla7w9q35
useCallSessionStore.tsx:148 [CallSessionStore] Session removed: call_1763097983889_bla7w9q35
useCallSessionStore.tsx:711 [CallSessionStore] CALL_READY throttled
useCallSessionStore.tsx:94 [CallSessionStore] Removing terminal session: call_1763097983889_bla7w9q35
useCallSessionStore.tsx:148 [CallSessionStore] Session removed: call_1763097983889_bla7w9q35
useCallSessionStore.tsx:711 [CallSessionStore] CALL_READY throttled
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:1110 [SW] Syncing badge count with server
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:1110 [SW] Syncing badge count with server
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:674 [SW] Retrieved pending call sessions: 0
sw.js:674 [SW] Retrieved pending call sessions: 0
