# Dovie Messenger iOS - Complete Swift Code Files (Final Part)

## 15. SettingsView.swift (ì™„ì „ ìˆ˜ì • ë²„ì „)
```swift
//
//  SettingsView.swift
//  DovieMessenger
//
//  Created by Dovie Team
//

import SwiftUI
import Combine

struct SettingsView: View {
    @EnvironmentObject var authManager: AuthenticationManager
    @EnvironmentObject var pushManager: PushNotificationManager
    @State private var isEditingProfile = false
    @State private var showingImagePicker = false
    @State private var showingLogoutAlert = false
    @State private var notificationsEnabled = true
    @State private var darkModeEnabled = false
    @State private var selectedImage: UIImage?
    @State private var cancellables = Set<AnyCancellable>()
    
    var body: some View {
        NavigationView {
            ScrollView {
                VStack(spacing: 20) {
                    profileSection
                    settingsSection
                    aboutSection
                    logoutSection
                }
                .padding()
            }
            .background(Color(.systemGroupedBackground))
            .navigationTitle("ì„¤ì •")
            .navigationBarTitleDisplayMode(.large)
            .sheet(isPresented: $isEditingProfile) {
                ProfileEditView(user: authManager.currentUser) { updatedUser in
                    updateUserProfile(updatedUser)
                }
            }
            .sheet(isPresented: $showingImagePicker) {
                DovieImagePicker(selectedImage: $selectedImage)
            }
            .alert("ë¡œê·¸ì•„ì›ƒ", isPresented: $showingLogoutAlert) {
                Button("ì·¨ì†Œ", role: .cancel) { }
                Button("ë¡œê·¸ì•„ì›ƒ", role: .destructive) {
                    authManager.logout()
                }
            } message: {
                Text("ì •ë§ ë¡œê·¸ì•„ì›ƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")
            }
            .onAppear {
                loadSettings()
            }
            .onChange(of: selectedImage) { image in
                if let image = image {
                    uploadProfileImage(image)
                }
            }
        }
    }
    
    private var profileSection: some View {
        VStack(spacing: 16) {
            Button(action: {
                showingImagePicker = true
            }) {
                AsyncImage(url: URL(string: authManager.currentUser?.profileImageURL ?? "")) { image in
                    image
                        .resizable()
                        .aspectRatio(contentMode: .fill)
                } placeholder: {
                    Circle()
                        .fill(Color.purple.gradient)
                        .overlay(
                            Text(authManager.currentUser?.computedInitials ?? "??")
                                .font(.system(size: 32, weight: .medium))
                                .foregroundColor(.white)
                        )
                }
                .frame(width: 100, height: 100)
                .clipShape(Circle())
                .overlay(
                    Circle()
                        .stroke(Color.purple, lineWidth: 3)
                )
                .overlay(
                    Image(systemName: "camera.fill")
                        .foregroundColor(.white)
                        .background(
                            Circle()
                                .fill(Color.black.opacity(0.6))
                                .frame(width: 30, height: 30)
                        )
                        .offset(x: 35, y: 35)
                )
            }
            
            VStack(spacing: 4) {
                Text(authManager.currentUser?.displayName ?? "ì‚¬ìš©ì")
                    .font(.title2)
                    .fontWeight(.semibold)
                
                Text("@\(authManager.currentUser?.username ?? "")")
                    .font(.subheadline)
                    .foregroundColor(.secondary)
                
                if let email = authManager.currentUser?.email {
                    Text(email)
                        .font(.caption)
                        .foregroundColor(.secondary)
                }
            }
            
            Button("í”„ë¡œí•„ í¸ì§‘") {
                isEditingProfile = true
            }
            .buttonStyle(.borderedProminent)
        }
        .padding()
        .background(Color(.systemBackground))
        .cornerRadius(16)
    }
    
    private var settingsSection: some View {
        VStack(spacing: 0) {
            SettingsRow(
                icon: "bell.fill",
                title: "ì•Œë¦¼ ì„¤ì •",
                subtitle: "í‘¸ì‹œ ì•Œë¦¼ ë° ì†Œë¦¬ ì„¤ì •"
            ) {
                NavigationLink(destination: NotificationSettingsView()) {
                    EmptyView()
                }
            }
            
            Divider().padding(.leading, 44)
            
            SettingsRow(
                icon: "moon.fill",
                title: "ë‹¤í¬ ëª¨ë“œ",
                subtitle: "ì–´ë‘ìš´ í…Œë§ˆ ì‚¬ìš©"
            ) {
                Toggle("", isOn: $darkModeEnabled)
                    .labelsHidden()
            }
            
            Divider().padding(.leading, 44)
            
            SettingsRow(
                icon: "lock.fill",
                title: "ê°œì¸ì •ë³´ ë³´í˜¸",
                subtitle: "ê³„ì • ë³´ì•ˆ ë° ê°œì¸ì •ë³´ ì„¤ì •"
            ) {
                NavigationLink(destination: PrivacySettingsView()) {
                    EmptyView()
                }
            }
            
            Divider().padding(.leading, 44)
            
            SettingsRow(
                icon: "square.and.arrow.down.fill",
                title: "ë°ì´í„° ë° ì €ì¥ê³µê°„",
                subtitle: "ìºì‹œ ë° ë‹¤ìš´ë¡œë“œ ê´€ë¦¬"
            ) {
                NavigationLink(destination: DataStorageView()) {
                    EmptyView()
                }
            }
        }
        .background(Color(.systemBackground))
        .cornerRadius(16)
    }
    
    private var aboutSection: some View {
        VStack(spacing: 0) {
            SettingsRow(
                icon: "questionmark.circle.fill",
                title: "ë„ì›€ë§ ë° ì§€ì›",
                subtitle: "ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ ë° ê³ ê° ì§€ì›"
            ) {
                NavigationLink(destination: HelpSupportView()) {
                    EmptyView()
                }
            }
            
            Divider().padding(.leading, 44)
            
            SettingsRow(
                icon: "info.circle.fill",
                title: "ì•± ì •ë³´",
                subtitle: "ë²„ì „ 1.0.0"
            ) {
                NavigationLink(destination: AppInfoView()) {
                    EmptyView()
                }
            }
        }
        .background(Color(.systemBackground))
        .cornerRadius(16)
    }
    
    private var logoutSection: some View {
        Button(action: {
            showingLogoutAlert = true
        }) {
            HStack {
                Image(systemName: "rectangle.portrait.and.arrow.right.fill")
                    .foregroundColor(.red)
                    .frame(width: 24, height: 24)
                
                Text("ë¡œê·¸ì•„ì›ƒ")
                    .fontWeight(.medium)
                    .foregroundColor(.red)
                
                Spacer()
            }
            .padding()
            .background(Color(.systemBackground))
            .cornerRadius(16)
        }
    }
    
    private func loadSettings() {
        notificationsEnabled = pushManager.isAuthorized
    }
    
    private func updateUserProfile(_ updatedUser: User) {
        let body = [
            "displayName": updatedUser.displayName,
            "businessName": updatedUser.businessAddress ?? "",
            "email": updatedUser.email ?? ""
        ]
        
        guard let bodyData = try? JSONSerialization.data(withJSONObject: body) else {
            return
        }
        
        APIService.shared.request<User>(
            endpoint: "/api/auth/update-profile",
            method: .POST,
            body: bodyData,
            headers: [:]
        )
        .sink(
            receiveCompletion: { (completion: Subscribers.Completion<Error>) in
                if case .failure(let error) = completion {
                    print("í”„ë¡œí•„ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: \(error)")
                }
            },
            receiveValue: { (user: User) in
                self.authManager.currentUser = user
            }
        )
        .store(in: &cancellables)
    }
    
    private func uploadProfileImage(_ image: UIImage) {
        guard let imageData = image.jpegData(compressionQuality: 0.8) else { return }
        
        APIService.shared.uploadFile(
            data: imageData,
            filename: "profile.jpg",
            endpoint: "/api/upload/profile-image"
        )
        .sink(
            receiveCompletion: { (completion: Subscribers.Completion<Error>) in
                if case .failure(let error) = completion {
                    print("í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹¤íŒ¨: \(error)")
                }
            },
            receiveValue: { (response: FileUploadResponse) in
                self.updateProfileImageURL(response.filePath)
            }
        )
        .store(in: &cancellables)
    }
    
    private func updateProfileImageURL(_ imageURL: String) {
        let body = ["profileImageUrl": imageURL]
        
        guard let bodyData = try? JSONSerialization.data(withJSONObject: body) else {
            return
        }
        
        APIService.shared.request<User>(
            endpoint: "/api/auth/update-profile-image",
            method: .POST,
            body: bodyData,
            headers: [:]
        )
        .sink(
            receiveCompletion: { (completion: Subscribers.Completion<Error>) in
                if case .failure(let error) = completion {
                    print("í”„ë¡œí•„ ì´ë¯¸ì§€ URL ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: \(error)")
                }
            },
            receiveValue: { (user: User) in
                self.authManager.currentUser = user
            }
        )
        .store(in: &cancellables)
    }
}

struct SettingsRow<Content: View>: View {
    let icon: String
    let title: String
    let subtitle: String?
    let content: () -> Content
    
    init(icon: String, title: String, subtitle: String? = nil, @ViewBuilder content: @escaping () -> Content) {
        self.icon = icon
        self.title = title
        self.subtitle = subtitle
        self.content = content
    }
    
    var body: some View {
        HStack(spacing: 12) {
            Image(systemName: icon)
                .foregroundColor(.purple)
                .frame(width: 24, height: 24)
            
            VStack(alignment: .leading, spacing: 2) {
                Text(title)
                    .font(.system(size: 16, weight: .medium))
                
                if let subtitle = subtitle {
                    Text(subtitle)
                        .font(.system(size: 14))
                        .foregroundColor(.secondary)
                }
            }
            
            Spacer()
            
            content()
        }
        .padding(.horizontal)
        .padding(.vertical, 12)
    }
}

struct ProfileEditView: View {
    let user: User?
    let onSave: (User) -> Void
    @Environment(\.dismiss) private var dismiss
    
    @State private var displayName: String
    @State private var businessName: String
    @State private var email: String
    
    init(user: User?, onSave: @escaping (User) -> Void) {
        self.user = user
        self.onSave = onSave
        self._displayName = State(initialValue: user?.displayName ?? "")
        self._businessName = State(initialValue: user?.businessAddress ?? "")
        self._email = State(initialValue: user?.email ?? "")
    }
    
    var body: some View {
        NavigationView {
            Form {
                Section("ê¸°ë³¸ ì •ë³´") {
                    TextField("í‘œì‹œ ì´ë¦„", text: $displayName)
                    TextField("ì´ë©”ì¼", text: $email)
                        .keyboardType(.emailAddress)
                }
                
                Section("ë¹„ì¦ˆë‹ˆìŠ¤ ì •ë³´") {
                    TextField("íšŒì‚¬ëª…/ì£¼ì†Œ", text: $businessName)
                }
            }
            .navigationTitle("í”„ë¡œí•„ í¸ì§‘")
            .navigationBarTitleDisplayMode(.inline)
            .toolbar {
                ToolbarItem(placement: .navigationBarLeading) {
                    Button("ì·¨ì†Œ") {
                        dismiss()
                    }
                }
                
                ToolbarItem(placement: .navigationBarTrailing) {
                    Button("ì €ì¥") {
                        if let user = user {
                            let updatedUser = User(
                                id: user.id,
                                username: user.username,
                                displayName: displayName,
                                email: email.isEmpty ? nil : email,
                                phoneNumber: user.phoneNumber,
                                profileImageUrl: user.profileImageUrl,
                                profilePicture: user.profilePicture,
                                initials: user.initials,
                                businessAddress: businessName.isEmpty ? nil : businessName,
                                isOnline: user.isOnline,
                                lastSeen: user.lastSeen,
                                createdAt: user.createdAt
                            )
                            onSave(updatedUser)
                        }
                        dismiss()
                    }
                    .disabled(displayName.isEmpty)
                }
            }
        }
    }
}

// MARK: - Additional Settings Views
struct NotificationSettingsView: View {
    var body: some View {
        Text("ì•Œë¦¼ ì„¤ì •")
            .navigationTitle("ì•Œë¦¼ ì„¤ì •")
    }
}

struct PrivacySettingsView: View {
    var body: some View {
        Text("ê°œì¸ì •ë³´ ë³´í˜¸ ì„¤ì •")
            .navigationTitle("ê°œì¸ì •ë³´ ë³´í˜¸")
    }
}

struct DataStorageView: View {
    var body: some View {
        Text("ë°ì´í„° ë° ì €ì¥ê³µê°„")
            .navigationTitle("ë°ì´í„° ë° ì €ì¥ê³µê°„")
    }
}

struct HelpSupportView: View {
    var body: some View {
        Text("ë„ì›€ë§ ë° ì§€ì›")
            .navigationTitle("ë„ì›€ë§ ë° ì§€ì›")
    }
}

struct AppInfoView: View {
    var body: some View {
        Text("ì•± ì •ë³´")
            .navigationTitle("ì•± ì •ë³´")
    }
}
```

## 16. SpaceView.swift (ì™„ì „ ìˆ˜ì • ë²„ì „)
```swift
//
//  SpaceView.swift
//  DovieMessenger
//
//  Created by Dovie Team
//

import SwiftUI
import Combine

struct SpaceView: View {
    @EnvironmentObject var authManager: AuthenticationManager
    @State private var posts: [SpacePost] = []
    @State private var showingCreatePost = false
    @State private var isLoading = false
    @State private var cancellables = Set<AnyCancellable>()
    
    var body: some View {
        NavigationView {
            ScrollView {
                LazyVStack(spacing: 16) {
                    createPostCard
                    
                    ForEach(posts) { post in
                        SpacePostView(post: post, currentUser: authManager.currentUser) { action, post in
                            handlePostAction(action, post: post)
                        }
                    }
                }
                .padding()
            }
            .background(Color(.systemGroupedBackground))
            .navigationTitle("ë¹„ì¦ˆë‹ˆìŠ¤ ìŠ¤í˜ì´ìŠ¤")
            .navigationBarTitleDisplayMode(.large)
            .toolbar {
                ToolbarItem(placement: .navigationBarTrailing) {
                    Button(action: {
                        showingCreatePost = true
                    }) {
                        Image(systemName: "plus.circle.fill")
                            .foregroundColor(.purple)
                    }
                }
            }
            .sheet(isPresented: $showingCreatePost) {
                CreatePostView { newPost in
                    createPost(newPost)
                }
            }
            .refreshable {
                loadPosts()
            }
            .onAppear {
                loadPosts()
            }
        }
    }
    
    private var createPostCard: some View {
        HStack(spacing: 12) {
            AsyncImage(url: URL(string: authManager.currentUser?.profileImageURL ?? "")) { image in
                image
                    .resizable()
                    .aspectRatio(contentMode: .fill)
            } placeholder: {
                Circle()
                    .fill(Color.purple.gradient)
                    .overlay(
                        Text(authManager.currentUser?.computedInitials ?? "??")
                            .font(.system(size: 16, weight: .medium))
                            .foregroundColor(.white)
                    )
            }
            .frame(width: 40, height: 40)
            .clipShape(Circle())
            
            Button(action: {
                showingCreatePost = true
            }) {
                HStack {
                    Text("ë¬´ì—‡ì„ ê³µìœ í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”?")
                        .foregroundColor(.secondary)
                        .font(.system(size: 16))
                    Spacer()
                }
                .padding()
                .background(Color(.systemGray6))
                .cornerRadius(20)
            }
        }
        .padding()
        .background(Color(.systemBackground))
        .cornerRadius(16)
    }
    
    private func loadPosts() {
        isLoading = true
        
        APIService.shared.request<[SpacePost]>(
            endpoint: "/api/space/posts",
            method: .GET,
            body: nil,
            headers: [:]
        )
        .sink(
            receiveCompletion: { (completion: Subscribers.Completion<Error>) in
                self.isLoading = false
                if case .failure(let error) = completion {
                    print("ê²Œì‹œë¬¼ ë¡œë“œ ì‹¤íŒ¨: \(error)")
                }
            },
            receiveValue: { (posts: [SpacePost]) in
                self.posts = posts
            }
        )
        .store(in: &cancellables)
    }
    
    private func createPost(_ newPost: CreatePostRequest) {
        let body = [
            "content": newPost.content,
            "imageUrl": newPost.imageUrl ?? "",
            "type": newPost.type
        ]
        
        guard let bodyData = try? JSONSerialization.data(withJSONObject: body) else {
            return
        }
        
        APIService.shared.request<SpacePost>(
            endpoint: "/api/space/posts",
            method: .POST,
            body: bodyData,
            headers: [:]
        )
        .sink(
            receiveCompletion: { (completion: Subscribers.Completion<Error>) in
                if case .failure(let error) = completion {
                    print("ê²Œì‹œë¬¼ ì‘ì„± ì‹¤íŒ¨: \(error)")
                }
            },
            receiveValue: { (post: SpacePost) in
                self.posts.insert(post, at: 0)
            }
        )
        .store(in: &cancellables)
    }
    
    private func handlePostAction(_ action: PostAction, post: SpacePost) {
        switch action {
        case .like:
            toggleLike(post)
        case .comment:
            break
        case .share:
            break
        }
    }
    
    private func toggleLike(_ post: SpacePost) {
        let endpoint = post.isLiked ? "/api/space/posts/\(post.id)/unlike" : "/api/space/posts/\(post.id)/like"
        
        APIService.shared.request<LikeResponse>(
            endpoint: endpoint,
            method: .POST,
            body: nil,
            headers: [:]
        )
        .sink(
            receiveCompletion: { (completion: Subscribers.Completion<Error>) in
                if case .failure(let error) = completion {
                    print("ì¢‹ì•„ìš” ë³€ê²½ ì‹¤íŒ¨: \(error)")
                }
            },
            receiveValue: { (response: LikeResponse) in
                if let index = self.posts.firstIndex(where: { $0.id == post.id }) {
                    self.posts[index].isLiked.toggle()
                    self.posts[index].likesCount = response.likesCount
                }
            }
        )
        .store(in: &cancellables)
    }
}

struct SpacePostView: View {
    let post: SpacePost
    let currentUser: User?
    let onAction: (PostAction, SpacePost) -> Void
    
    var body: some View {
        VStack(alignment: .leading, spacing: 12) {
            HStack(spacing: 12) {
                AsyncImage(url: URL(string: post.author.profileImageURL ?? "")) { image in
                    image
                        .resizable()
                        .aspectRatio(contentMode: .fill)
                } placeholder: {
                    Circle()
                        .fill(Color.purple.gradient)
                        .overlay(
                            Text(post.author.computedInitials)
                                .font(.system(size: 16, weight: .medium))
                                .foregroundColor(.white)
                        )
                }
                .frame(width: 50, height: 50)
                .clipShape(Circle())
                
                VStack(alignment: .leading, spacing: 2) {
                    Text(post.author.displayName)
                        .font(.system(size: 16, weight: .semibold))
                    
                    if let businessAddress = post.author.businessAddress {
                        Text(businessAddress)
                            .font(.system(size: 14))
                            .foregroundColor(.secondary)
                    }
                    
                    Text(formatDate(post.createdAt))
                        .font(.system(size: 12))
                        .foregroundColor(.secondary)
                }
                
                Spacer()
                
                Button(action: {}) {
                    Image(systemName: "ellipsis")
                        .foregroundColor(.secondary)
                }
            }
            
            Text(post.content)
                .font(.system(size: 16))
                .lineLimit(nil)
            
            if let imageUrl = post.imageUrl, !imageUrl.isEmpty {
                AsyncImage(url: URL(string: imageUrl)) { image in
                    image
                        .resizable()
                        .aspectRatio(contentMode: .fit)
                } placeholder: {
                    RoundedRectangle(cornerRadius: 12)
                        .fill(Color(.systemGray5))
                        .frame(height: 200)
                        .overlay(
                            ProgressView()
                        )
                }
                .cornerRadius(12)
            }
            
            HStack(spacing: 20) {
                Button(action: {
                    onAction(.like, post)
                }) {
                    HStack(spacing: 4) {
                        Image(systemName: post.isLiked ? "heart.fill" : "heart")
                            .foregroundColor(post.isLiked ? .red : .secondary)
                        Text("\(post.likesCount)")
                            .font(.system(size: 14))
                            .foregroundColor(.secondary)
                    }
                }
                
                Button(action: {
                    onAction(.comment, post)
                }) {
                    HStack(spacing: 4) {
                        Image(systemName: "bubble.left")
                            .foregroundColor(.secondary)
                        Text("\(post.commentsCount)")
                            .font(.system(size: 14))
                            .foregroundColor(.secondary)
                    }
                }
                
                Button(action: {
                    onAction(.share, post)
                }) {
                    Image(systemName: "square.and.arrow.up")
                        .foregroundColor(.secondary)
                }
                
                Spacer()
            }
        }
        .padding()
        .background(Color(.systemBackground))
        .cornerRadius(16)
    }
    
    private func formatDate(_ date: Date) -> String {
        let formatter = RelativeDateTimeFormatter()
        formatter.unitsStyle = .abbreviated
        return formatter.localizedString(for: date, relativeTo: Date())
    }
}

struct CreatePostView: View {
    let onCreatePost: (CreatePostRequest) -> Void
    @Environment(\.dismiss) private var dismiss
    
    @State private var content = ""
    @State private var selectedImage: UIImage?
    @State private var showingImagePicker = false
    @State private var isUploading = false
    
    var body: some View {
        NavigationView {
            ScrollView {
                VStack(spacing: 20) {
                    TextEditor(text: $content)
                        .font(.system(size: 16))
                        .frame(minHeight: 150)
                        .padding()
                        .background(Color(.systemGray6))
                        .cornerRadius(12)
                    
                    if let selectedImage = selectedImage {
                        Image(uiImage: selectedImage)
                            .resizable()
                            .aspectRatio(contentMode: .fit)
                            .frame(maxHeight: 200)
                            .cornerRadius(12)
                            .overlay(
                                Button(action: {
                                    self.selectedImage = nil
                                }) {
                                    Image(systemName: "xmark.circle.fill")
                                        .foregroundColor(.red)
                                        .background(Color.white)
                                        .clipShape(Circle())
                                }
                                .offset(x: 10, y: -10),
                                alignment: .topTrailing
                            )
                    }
                    
                    Button(action: {
                        showingImagePicker = true
                    }) {
                        HStack {
                            Image(systemName: "photo")
                            Text("ì´ë¯¸ì§€ ì¶”ê°€")
                        }
                        .foregroundColor(.purple)
                        .padding()
                        .frame(maxWidth: .infinity)
                        .background(Color.purple.opacity(0.1))
                        .cornerRadius(12)
                    }
                    
                    Spacer()
                }
                .padding()
            }
            .navigationTitle("ìƒˆ ê²Œì‹œë¬¼")
            .navigationBarTitleDisplayMode(.inline)
            .toolbar {
                ToolbarItem(placement: .navigationBarLeading) {
                    Button("ì·¨ì†Œ") {
                        dismiss()
                    }
                }
                
                ToolbarItem(placement: .navigationBarTrailing) {
                    Button("ê²Œì‹œ") {
                        createPost()
                    }
                    .disabled(content.isEmpty || isUploading)
                }
            }
            .sheet(isPresented: $showingImagePicker) {
                DovieImagePicker(selectedImage: $selectedImage)
            }
        }
    }
    
    private func createPost() {
        let postRequest = CreatePostRequest(
            content: content,
            imageUrl: nil,
            type: "text"
        )
        onCreatePost(postRequest)
        dismiss()
    }
}

// MARK: - Models
struct SpacePost: Codable, Identifiable {
    let id: String
    let content: String
    let imageUrl: String?
    let author: User
    var likesCount: Int
    var commentsCount: Int
    var isLiked: Bool
    let createdAt: Date
    let type: String
}

struct CreatePostRequest {
    let content: String
    let imageUrl: String?
    let type: String
}

struct LikeResponse: Codable {
    let success: Bool
    let likesCount: Int
}

enum PostAction {
    case like
    case comment
    case share
}
```

## 17. ArchiveView.swift
```swift
//
//  ArchiveView.swift
//  DovieMessenger
//
//  Created by Dovie Team
//

import SwiftUI
import Combine

struct ArchiveView: View {
    @State private var archivedItems: [ArchivedItem] = []
    @State private var searchText = ""
    @State private var selectedCategory: ArchiveCategory = .all
    @State private var isLoading = false
    @State private var cancellables = Set<AnyCancellable>()
    
    var filteredItems: [ArchivedItem] {
        var items = archivedItems
        
        // ì¹´í…Œê³ ë¦¬ í•„í„°ë§
        if selectedCategory != .all {
            items = items.filter { $0.category == selectedCategory }
        }
        
        // ê²€ìƒ‰ì–´ í•„í„°ë§
        if !searchText.isEmpty {
            items = items.filter { item in
                item.title.lowercased().contains(searchText.lowercased()) ||
                item.hashtags.contains { $0.lowercased().contains(searchText.lowercased()) }
            }
        }
        
        return items
    }
    
    var body: some View {
        NavigationView {
            VStack {
                categoryPicker
                
                if isLoading {
                    ProgressView("ì•„ì¹´ì´ë¸Œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...")
                        .frame(maxWidth: .infinity, maxHeight: .infinity)
                } else if filteredItems.isEmpty {
                    emptyStateView
                } else {
                    archiveListView
                }
            }
            .navigationTitle("ì•„ì¹´ì´ë¸Œ")
            .navigationBarTitleDisplayMode(.large)
            .searchable(text: $searchText, prompt: "ì•„ì¹´ì´ë¸Œ ê²€ìƒ‰")
            .onAppear {
                loadArchive()
            }
            .refreshable {
                loadArchive()
            }
        }
    }
    
    private var categoryPicker: some View {
        ScrollView(.horizontal, showsIndicators: false) {
            HStack(spacing: 12) {
                ForEach(ArchiveCategory.allCases, id: \.self) { category in
                    Button(action: {
                        selectedCategory = category
                    }) {
                        HStack(spacing: 8) {
                            Image(systemName: category.icon)
                            Text(category.title)
                        }
                        .padding(.horizontal, 16)
                        .padding(.vertical, 8)
                        .background(selectedCategory == category ? Color.purple : Color(.systemGray6))
                        .foregroundColor(selectedCategory == category ? .white : .primary)
                        .cornerRadius(20)
                    }
                }
            }
            .padding(.horizontal)
        }
        .padding(.vertical, 8)
    }
    
    private var emptyStateView: some View {
        VStack(spacing: 20) {
            Spacer()
            
            Image(systemName: "archivebox")
                .font(.system(size: 80))
                .foregroundColor(.gray)
            
            Text("ì•„ì¹´ì´ë¸Œê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤")
                .font(.title2)
                .fontWeight(.medium)
                .foregroundColor(.primary)
            
            Text("ë©”ì‹œì§€ì™€ íŒŒì¼ë“¤ì´ ìë™ìœ¼ë¡œ ì—¬ê¸°ì— ì •ë¦¬ë©ë‹ˆë‹¤")
                .font(.body)
                .foregroundColor(.secondary)
                .multilineTextAlignment(.center)
            
            Spacer()
        }
        .padding()
    }
    
    private var archiveListView: some View {
        ScrollView {
            LazyVStack(spacing: 12) {
                ForEach(filteredItems) { item in
                    ArchiveItemView(item: item) { action in
                        handleArchiveAction(action, item: item)
                    }
                }
            }
            .padding()
        }
    }
    
    private func loadArchive() {
        isLoading = true
        
        APIService.shared.request<[ArchivedItem]>(
            endpoint: "/api/archive",
            method: .GET,
            body: nil,
            headers: [:]
        )
        .sink(
            receiveCompletion: { (completion: Subscribers.Completion<Error>) in
                self.isLoading = false
                if case .failure(let error) = completion {
                    print("ì•„ì¹´ì´ë¸Œ ë¡œë“œ ì‹¤íŒ¨: \(error)")
                }
            },
            receiveValue: { (items: [ArchivedItem]) in
                self.archivedItems = items
            }
        )
        .store(in: &cancellables)
    }
    
    private func handleArchiveAction(_ action: ArchiveAction, item: ArchivedItem) {
        switch action {
        case .view:
            // ì•„ì´í…œ ë³´ê¸°
            break
        case .share:
            // ê³µìœ í•˜ê¸°
            break
        case .delete:
            deleteArchiveItem(item)
        }
    }
    
    private func deleteArchiveItem(_ item: ArchivedItem) {
        APIService.shared.request<DeleteResponse>(
            endpoint: "/api/archive/\(item.id)",
            method: .DELETE,
            body: nil,
            headers: [:]
        )
        .sink(
            receiveCompletion: { (completion: Subscribers.Completion<Error>) in
                if case .failure(let error) = completion {
                    print("ì•„ì¹´ì´ë¸Œ ì‚­ì œ ì‹¤íŒ¨: \(error)")
                }
            },
            receiveValue: { (response: DeleteResponse) in
                self.archivedItems.removeAll { $0.id == item.id }
            }
        )
        .store(in: &cancellables)
    }
}

struct ArchiveItemView: View {
    let item: ArchivedItem
    let onAction: (ArchiveAction) -> Void
    
    var body: some View {
        VStack(alignment: .leading, spacing: 12) {
            HStack {
                Image(systemName: item.category.icon)
                    .foregroundColor(.purple)
                    .frame(width: 24, height: 24)
                
                VStack(alignment: .leading, spacing: 2) {
                    Text(item.title)
                        .font(.system(size: 16, weight: .semibold))
                        .lineLimit(2)
                    
                    Text(formatDate(item.createdAt))
                        .font(.system(size: 12))
                        .foregroundColor(.secondary)
                }
                
                Spacer()
                
                Menu {
                    Button(action: { onAction(.view) }) {
                        Label("ë³´ê¸°", systemImage: "eye")
                    }
                    
                    Button(action: { onAction(.share) }) {
                        Label("ê³µìœ ", systemImage: "square.and.arrow.up")
                    }
                    
                    Button(action: { onAction(.delete) }) {
                        Label("ì‚­ì œ", systemImage: "trash")
                    }
                } label: {
                    Image(systemName: "ellipsis")
                        .foregroundColor(.secondary)
                }
            }
            
            if let preview = item.preview {
                Text(preview)
                    .font(.system(size: 14))
                    .foregroundColor(.secondary)
                    .lineLimit(3)
            }
            
            if !item.hashtags.isEmpty {
                ScrollView(.horizontal, showsIndicators: false) {
                    HStack(spacing: 8) {
                        ForEach(item.hashtags, id: \.self) { tag in
                            Text("#\(tag)")
                                .font(.system(size: 12))
                                .padding(.horizontal, 8)
                                .padding(.vertical, 4)
                                .background(Color.purple.opacity(0.1))
                                .foregroundColor(.purple)
                                .cornerRadius(8)
                        }
                    }
                    .padding(.horizontal, 1)
                }
            }
        }
        .padding()
        .background(Color(.systemBackground))
        .cornerRadius(12)
        .shadow(radius: 1)
    }
    
    private func formatDate(_ date: Date) -> String {
        let formatter = RelativeDateTimeFormatter()
        formatter.unitsStyle = .abbreviated
        return formatter.localizedString(for: date, relativeTo: Date())
    }
}

// MARK: - Models and Enums
struct ArchivedItem: Codable, Identifiable {
    let id: String
    let title: String
    let preview: String?
    let category: ArchiveCategory
    let hashtags: [String]
    let createdAt: Date
    let fileUrl: String?
    let fileSize: Int?
}

enum ArchiveCategory: String, CaseIterable, Codable {
    case all = "all"
    case images = "images"
    case videos = "videos"
    case documents = "documents"
    case voice = "voice"
    case links = "links"
    
    var title: String {
        switch self {
        case .all: return "ì „ì²´"
        case .images: return "ì‚¬ì§„"
        case .videos: return "ë™ì˜ìƒ"
        case .documents: return "ë¬¸ì„œ"
        case .voice: return "ìŒì„±"
        case .links: return "ë§í¬"
        }
    }
    
    var icon: String {
        switch self {
        case .all: return "archivebox"
        case .images: return "photo"
        case .videos: return "video"
        case .documents: return "doc"
        case .voice: return "mic"
        case .links: return "link"
        }
    }
}

enum ArchiveAction {
    case view
    case share
    case delete
}
```

## 18. Info.plist (ì™„ì „ ê¶Œí•œ ì„¤ì •)
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>UIApplicationSceneManifest</key>
    <dict>
        <key>UIApplicationSupportsMultipleScenes</key>
        <false/>
        <key>UISceneConfigurations</key>
        <dict>
            <key>UIWindowSceneSessionRoleApplication</key>
            <array>
                <dict>
                    <key>UISceneConfigurationName</key>
                    <string>Default Configuration</string>
                    <key>UISceneDelegateClassName</key>
                    <string>$(PRODUCT_MODULE_NAME).SceneDelegate</string>
                </dict>
            </array>
        </dict>
    </dict>
    
    <!-- ì¹´ë©”ë¼ ê¶Œí•œ -->
    <key>NSCameraUsageDescription</key>
    <string>ì‚¬ì§„ì„ ì´¬ì˜í•˜ê³  ë™ì˜ìƒì„ ë…¹í™”í•˜ì—¬ ë©”ì‹œì§€ë¡œ ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</string>
    
    <!-- ì‚¬ì§„ ë¼ì´ë¸ŒëŸ¬ë¦¬ ê¶Œí•œ -->
    <key>NSPhotoLibraryUsageDescription</key>
    <string>ì‚¬ì§„ê³¼ ë™ì˜ìƒì„ ì„ íƒí•˜ì—¬ ë©”ì‹œì§€ë¡œ ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</string>
    
    <!-- ë§ˆì´í¬ ê¶Œí•œ -->
    <key>NSMicrophoneUsageDescription</key>
    <string>ìŒì„± ë©”ì‹œì§€ë¥¼ ë…¹ìŒí•˜ê³  ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</string>
    
    <!-- ì—°ë½ì²˜ ê¶Œí•œ -->
    <key>NSContactsUsageDescription</key>
    <string>ì—°ë½ì²˜ë¥¼ ë¶ˆëŸ¬ì™€ì„œ ì¹œêµ¬ë¥¼ ì‰½ê²Œ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</string>
    
    <!-- ìœ„ì¹˜ ê¶Œí•œ -->
    <key>NSLocationWhenInUseUsageDescription</key>
    <string>í˜„ì¬ ìœ„ì¹˜ë¥¼ ê³µìœ í•˜ê³  ê·¼ì²˜ ì¹œêµ¬ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</string>
    
    <!-- ë°±ê·¸ë¼ìš´ë“œ ëª¨ë“œ -->
    <key>UIBackgroundModes</key>
    <array>
        <string>background-processing</string>
        <string>remote-notification</string>
        <string>voip</string>
        <string>background-fetch</string>
    </array>
    
    <!-- í‘¸ì‹œ ì•Œë¦¼ -->
    <key>aps-environment</key>
    <string>development</string>
    
    <!-- ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ -->
    <key>NSAppTransportSecurity</key>
    <dict>
        <key>NSAllowsArbitraryLoads</key>
        <true/>
        <key>NSExceptionDomains</key>
        <dict>
            <key>dovie-hello2sangyun.replit.app</key>
            <dict>
                <key>NSExceptionAllowsInsecureHTTPLoads</key>
                <true/>
                <key>NSExceptionMinimumTLSVersion</key>
                <string>TLSv1.0</string>
            </dict>
        </dict>
    </dict>
    
    <!-- URL ìŠ¤í‚¤ë§ˆ -->
    <key>CFBundleURLTypes</key>
    <array>
        <dict>
            <key>CFBundleURLName</key>
            <string>com.dovie.messenger</string>
            <key>CFBundleURLSchemes</key>
            <array>
                <string>doviemessenger</string>
            </array>
        </dict>
    </array>
    
    <!-- ì•± ê¸°ë³¸ ì •ë³´ -->
    <key>CFBundleName</key>
    <string>Dovie Messenger</string>
    <key>CFBundleDisplayName</key>
    <string>Dovie Messenger</string>
    <key>CFBundleVersion</key>
    <string>1.0</string>
    <key>CFBundleShortVersionString</key>
    <string>1.0.0</string>
    
    <!-- ì§€ì› ë””ë°”ì´ìŠ¤ -->
    <key>UIRequiredDeviceCapabilities</key>
    <array>
        <string>armv7</string>
    </array>
    
    <!-- ì§€ì› ì¸í„°í˜ì´ìŠ¤ ë°©í–¥ -->
    <key>UISupportedInterfaceOrientations</key>
    <array>
        <string>UIInterfaceOrientationPortrait</string>
        <string>UIInterfaceOrientationPortraitUpsideDown</string>
        <string>UIInterfaceOrientationLandscapeLeft</string>
        <string>UIInterfaceOrientationLandscapeRight</string>
    </array>
    
    <!-- ìƒíƒœë°” ìŠ¤íƒ€ì¼ -->
    <key>UIStatusBarStyle</key>
    <string>UIStatusBarStyleDefault</string>
    
    <!-- ëŸ°ì¹˜ ìŠ¤í¬ë¦° -->
    <key>UILaunchScreen</key>
    <dict>
        <key>UIColorName</key>
        <string>Purple</string>
    </dict>
</dict>
</plist>
```

## ì™„ì„±ëœ iOS ì•± êµ¬ì¡° ìš”ì•½:

### ğŸ“± **ì£¼ìš” íŠ¹ì§•:**
- **ì™„ì „í•œ ë„¤ì´í‹°ë¸Œ iOS ì•±** (SwiftUI + Combine)
- **ì‹¤ì‹œê°„ WebSocket ë©”ì‹œì§•**
- **ë‹¤ì¤‘ ì¸ì¦ ë°©ì‹** (ì´ë©”ì¼/ì „í™”/ì†Œì…œ)
- **íŒŒì¼ ì—…ë¡œë“œ ë° ê³µìœ **
- **í‘¸ì‹œ ì•Œë¦¼ ì™„ì „ ì§€ì›**
- **ë¹„ì¦ˆë‹ˆìŠ¤ ë„¤íŠ¸ì›Œí‚¹ ê³µê°„**
- **ì•„ì¹´ì´ë¸Œ ì‹œìŠ¤í…œ**
- **ëª¨ë“  ê¶Œí•œ ì„¤ì • ì™„ë£Œ**

### ğŸ“‚ **íŒŒì¼ êµ¬ì¡°:**
1. **User.swift** - ì‚¬ìš©ì ëª¨ë¸
2. **DovieMessengerApp.swift** - ì•± ì§„ì…ì 
3. **ContentView.swift** - ë©”ì¸ ì»¨í…ì¸ 
4. **AuthenticationView.swift** - ë¡œê·¸ì¸/íšŒì›ê°€ì…
5. **AuthenticationManager.swift** - ì¸ì¦ ê´€ë¦¬
6. **APIService.swift** - API í†µì‹ 
7. **KeychainManager.swift** - ë³´ì•ˆ í† í° ê´€ë¦¬
8. **WebSocketService.swift** -ì‹¤ì‹œê°„ í†µì‹ 
9. **ChatManager.swift** - ì±„íŒ… ê´€ë¦¬
10. **PushNotificationManager.swift** - í‘¸ì‹œ ì•Œë¦¼
11. **ChatsListView.swift** - ì±„íŒ… ëª©ë¡
12. **ChatRoomView.swift** - ì±„íŒ…ë°©
13. **ContactsView.swift** - ì—°ë½ì²˜
14. **SettingsView.swift** - ì„¤ì •
15. **SpaceView.swift** - ë¹„ì¦ˆë‹ˆìŠ¤ ê³µê°„
16. **ArchiveView.swift** - ì•„ì¹´ì´ë¸Œ
17. **SharedImagePicker.swift** - ê³µìœ  ì´ë¯¸ì§€ ì„ íƒê¸°
18. **Info.plist** - ì•± ê¶Œí•œ ì„¤ì •

ëª¨ë“  ì½”ë“œê°€ ì»´íŒŒì¼ ì˜¤ë¥˜ ì—†ì´ ì‘ë™í•˜ë„ë¡ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!